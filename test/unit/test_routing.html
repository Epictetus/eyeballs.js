<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <script src="../../dist/jquery/jquery-1.4.2.min.js"></script>
  <script src="../../dist/jquery/jquery.livequery.js"></script>
  <script src="../../dist/jquery/jquery.ba-hashchange.js"></script>
  <script src="../../src/o_O.js"></script>
  <script src="../../src/modules/o_O.model.js"></script>
  <script src="../../src/modules/o_O.validations.js"></script>
  <script src="../../src/drivers/jquery/adapters/o_O.dom.js"></script>
  <script src="../../src/drivers/jquery/modules/o_O.controller.js"></script>
  <script src="../../src/drivers/jquery/modules/o_O.support.js"></script>
  <script src="../../src/modules/o_O.routes.js"></script>
  <script src="../../src/drivers/jquery/modules/o_O.routes.js"></script>

  <link rel="stylesheet" href="qunit.css" type="text/css" media="screen" />
<script type="text/javascript" src="qunit.js"></script>

  <script>
  o_O('ReviewsController', {
    index: function(bit){
      var out;
      if(bit == 'test')
      {
        out = 'clicked!'
      }
      else
      {
        out = 'indexed!'
      }
      $('div#index').html(out);
      return 'whoop!'
    }
  });
  
  o_O.routes.draw(function(map){
    map.match('/', {to: "reviews#index", with: 'test'});
  })

  $(document).ready(function(){
    
    module("Simple Route");
    
    test('o_O.routes.urls', function(){
      equals(o_O.routes.urls[0], '/', 'should store the necessary URLs')
    })
    
    test('o_O.routes.rules', function(){
      equals(o_O.routes.rules['/'].action(), ReviewsController.index())
    })
    
    asyncTest('map.match',function(){
      $('a#index-link').trigger('click');
      setTimeout(function(){
        equals($('div#index').html(), 'clicked!', "should call the action");
        start();
      },100)
    })

  });
  </script>
  
</head>
<body>
  <h1 id="qunit-header">Controller Tests</h1>
  <h2 id="qunit-banner"></h2>
  <h2 id="qunit-userAgent"></h2>
  <ol id="qunit-tests"></ol>
 
  <a id="index-link" data-ajax-history="true" href="/">Hello!</a>
 
  <div id="index">
  </div>
</body>
</html>